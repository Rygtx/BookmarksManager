# 书签对比整理插件逻辑

## 总目标
- 快速找出两侧书签树的差异，给出清晰提示。
- 支持用户用最少操作完成合并、清理和同步。

## 基础数据
- 节点信息：`id(可选)`、`标题`、`规范化标题`、`URL`、`类型(文件夹/书签)`、`路径数组`、`父节点序号`。
- 为每侧书签构建哈希索引：`id -> 节点`、`URL -> 节点集合`、`路径 -> 节点集合`。

## 比对顺序
1. 逐个节点遍历左树（相同逻辑适用于右树）。
2. 优先匹配同 ID；缺失时尝试完全相同的 URL；再尝试完整路径与标题组合。
3. 若仍未命中，查找同路径下的同类型兄弟节点，按父节点序号最近者取第一优先。
4. 全部失败时记为“缺失”，保留源侧位置供用户处理。

## 结果标记
- 记录四类状态：`匹配`、`仅左侧存在`、`仅右侧存在`、`冲突/重复`。
- 在界面上采用颜色或图标高亮这些状态。

## 操作建议
- 为每个差异节点提供：`跳转另一侧`、`复制到另一侧`、`替换`、`删除` 基础操作。
- 支持批量接受/忽略差异，并在操作后自动刷新索引和标记。

## 反馈原则
- 每次自动定位都要展开路径、滚动到视线中央，并显示 Toast 说明原因（例如“按 URL 匹配成功”或“未找到匹配，定位到同级邻居”）。
- 所有失败场景都应给出明确文案，提示用户下一步操作。

## 异常处理
- 目标面板缺失、节点数据不完整、网络异常（如需云同步）等情况需即时提示并中断操作。
- 对重复匹配情况给出确认对话框，允许用户手动选择目标节点。

## 测试要点
- 覆盖含有重复标题、缺失 URL、深层文件夹、上万节点的大型数据集。
- 为匹配函数编写单元测试，确保比对顺序和优先级符合预期。
